<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LEVEL 23 â”€ è§’è‰²å‰µå»º</title>
  <style>
    :root{--neon:#5be4ff;--gold:#ffc857;}
    *{box-sizing:border-box;}
    html,body{margin:0;padding:0;height:100%;}
    body{
      font-family:"Segoe UI",system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
      background:radial-gradient(circle at top,#1b2742 0,#050816 42%,#02030a 100%);
      color:#f0f4ff;overflow:hidden;position:relative;
    }
    .stars{
      position:fixed;inset:0;
      background:radial-gradient(circle,rgba(255,255,255,.25) 1px,transparent 1px);
      background-size:3px 3px;opacity:.2;
      animation:starDrift 40s linear infinite;
      pointer-events:none;z-index:0;
    }
    @keyframes starDrift{from{transform:translateY(0);}to{transform:translateY(-900px);}}
    .tribal{
      position:fixed;inset:0;
      background:
        radial-gradient(circle at 0 0,rgba(91,228,255,.35),transparent 55%),
        radial-gradient(circle at 100% 100%,rgba(255,200,87,.3),transparent 55%),
        url("assets/patterns/puyuma.png") center/38% repeat;
      opacity:.14;mix-blend-mode:screen;
      animation:tribalPulse 7s ease-in-out infinite;
      pointer-events:none;z-index:0;
    }
    @keyframes tribalPulse{0%,100%{opacity:.08;filter:blur(0);}50%{opacity:.22;filter:blur(1px);}}
    .page{
      position:relative;z-index:2;height:100%;
      display:flex;align-items:center;justify-content:center;
      padding:20px;
    }
    .card{
      width:min(1020px,100%);max-height:92vh;
      background:linear-gradient(135deg,rgba(10,13,30,.96),rgba(7,6,20,.96));
      border-radius:20px;border:1px solid rgba(91,228,255,.7);
      box-shadow:0 0 26px rgba(0,0,0,.8),0 0 40px rgba(91,228,255,.45);
      display:grid;grid-template-columns:1.05fr 1.4fr;
      gap:22px;padding:22px 24px;backdrop-filter:blur(16px);
    }
    @media(max-width:900px){
      body{overflow:auto;}
      .page{align-items:flex-start;padding-top:22px;}
      .card{grid-template-columns:1fr;max-height:none;}
    }
    .left{border-right:1px solid rgba(255,255,255,.08);padding-right:16px;}
    @media(max-width:900px){.left{border-right:none;border-bottom:1px solid rgba(255,255,255,.08);padding-right:0;padding-bottom:14px;margin-bottom:10px;}}
    .right{padding-left:4px;}
    .badge{
      display:inline-flex;align-items:center;gap:6px;
      padding:4px 10px;border-radius:999px;
      border:1px solid rgba(91,228,255,.8);
      background:radial-gradient(circle at 0 0,rgba(91,228,255,.4),transparent 60%);
      font-size:11px;text-transform:uppercase;letter-spacing:1px;color:var(--neon);
    }
    h1{
      margin:8px 0 4px;font-size:24px;color:#fff7dd;
      text-shadow:0 0 10px rgba(91,228,255,.7),0 0 24px rgba(255,200,87,.6);
    }
    .subtitle{font-size:13px;opacity:.88;margin-bottom:14px;}
    .player-meta{font-size:13px;opacity:.88;margin-bottom:14px;}
    .player-meta span.label{opacity:.7;}
    .preview-card{
      margin-top:12px;padding:14px;border-radius:14px;
      border:1px solid rgba(255,200,87,.7);
      background:
        radial-gradient(circle at top,rgba(255,200,87,.25),transparent 60%),
        radial-gradient(circle at bottom,rgba(91,228,255,.18),transparent 60%),
        rgba(5,5,12,.9);
      font-size:13px;box-shadow:0 0 18px rgba(0,0,0,.7);
    }
    .preview-line{display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px;}
    .preview-label{opacity:.75;}
    .preview-value{text-align:right;font-weight:500;}
    form{
      display:grid;grid-template-columns:1fr 1fr;
      gap:10px 18px;font-size:13px;
      max-height:64vh;overflow-y:auto;padding-right:4px;
    }
    @media(max-width:900px){form{grid-template-columns:1fr;max-height:none;}}
    .field{display:flex;flex-direction:column;gap:4px;}
    label{font-size:12px;opacity:.9;}
    input[type="text"],input[type="number"],textarea,select{
      border-radius:9px;border:1px solid rgba(112,138,204,.9);
      background:radial-gradient(circle at top,rgba(91,228,255,.07),rgba(6,10,25,.96));
      padding:8px 10px;color:#f5f7ff;font-size:13px;outline:none;
    }
    textarea{resize:vertical;min-height:70px;max-height:130px;}
    input:focus,textarea:focus,select:focus{border-color:var(--neon);box-shadow:0 0 0 1px rgba(91,228,255,.4);}
    .field-title{
      grid-column:1/-1;margin-top:6px;font-size:11px;
      opacity:.8;text-transform:uppercase;letter-spacing:1px;
    }
    .stats-row{
      grid-column:1/-1;
      display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:10px;
    }
    @media(max-width:900px){.stats-row{grid-template-columns:repeat(2,minmax(0,1fr));}}
    .stat-box{
      padding:7px 8px;border-radius:10px;
      border:1px solid rgba(255,255,255,.2);
      background:rgba(8,12,30,.9);font-size:11px;
      display:flex;flex-direction:column;gap:3px;
    }
    .stat-box input{padding:4px 6px;font-size:12px;}
    .actions{
      grid-column:1/-1;margin-top:8px;
      display:flex;justify-content:flex-end;gap:8px;
    }
    .btn{
      border-radius:999px;padding:8px 16px;border:none;
      font-size:13px;cursor:pointer;
      display:inline-flex;align-items:center;gap:6px;
    }
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,.35);color:#e3ecff;}
    .btn-primary{
      background:linear-gradient(135deg,var(--gold),var(--neon));
      color:#050816;font-weight:600;
      box-shadow:0 0 16px rgba(255,200,87,.6),0 0 20px rgba(91,228,255,.5);
    }
    .hint{grid-column:1/-1;margin-top:4px;font-size:11px;opacity:.75;text-align:right;}
    .toast{
      position:fixed;right:16px;bottom:16px;
      padding:8px 14px;border-radius:999px;
      background:rgba(12,180,120,.14);
      border:1px solid rgba(12,180,120,.7);
      color:#d8ffe9;font-size:12px;
      backdrop-filter:blur(8px);
      opacity:0;transform:translateY(8px);
      pointer-events:none;transition:opacity .25s,transform .25s;
      z-index:10;
    }
    .toast.show{opacity:1;transform:translateY(0);}
  
    .completion-overlay{
      position:fixed;
      inset:0;
      z-index:30;
      display:none;
      align-items:center;
      justify-content:center;
      background:radial-gradient(circle at top, rgba(5,8,22,0.95), rgba(0,0,0,0.98));
      backdrop-filter:blur(10px);
    }
    .completion-panel{
      width:min(480px, 90%);
      padding:24px 22px 18px;
      border-radius:18px;
      background:rgba(10,12,28,0.96);
      border:1px solid rgba(255,201,119,0.85);
      box-shadow:0 0 32px rgba(0,0,0,0.9),0 0 26px rgba(255,201,119,0.45);
      text-align:center;
    }
    .completion-title{
      font-size:22px;
      letter-spacing:1px;
      color:#ffc977;
      margin-bottom:6px;
    }
    .completion-sub{
      font-size:13px;
      opacity:0.9;
      margin-bottom:14px;
    }
    .completion-line{
      font-size:13px;
      margin:3px 0;
    }
    .completion-line span.label{opacity:0.75;}
    .completion-actions{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin-top:14px;
    }
    .completion-btn{
      padding:10px 0;
      border-radius:999px;
      border:none;
      font-size:13px;
      cursor:pointer;
    }
    .completion-btn-primary{
      background:linear-gradient(135deg,#5ba8ff,#ffc977);
      color:#050816;
      font-weight:600;
    }
    .completion-btn-ghost{
      background:transparent;
      color:#e7f0ff;
      border:1px solid rgba(255,255,255,0.4);
    }


    .completion-avatar-wrap{
      width:84px;height:84px;
      border-radius:50%;
      margin:0 auto 10px;
      position:relative;
      overflow:hidden;
      border:2px solid rgba(255,200,135,0.95);
      box-shadow:0 0 16px rgba(255,200,135,0.8);
    }
    .completion-avatar-wrap img{
      width:100%;height:100%;object-fit:cover;
    }
    .completion-avatar-glow{
      position:absolute;
      inset:-20%;
      background:radial-gradient(circle,rgba(255,200,135,0.85),transparent 60%);
      mix-blend-mode:screen;
      opacity:.7;
      pointer-events:none;
      animation:completionGlow 3s ease-in-out infinite;
    }
    @keyframes completionGlow{
      0%,100%{opacity:.45;transform:scale(1);}
      50%{opacity:1;transform:scale(1.08);}
    }
    .completion-mini-card{
      margin-top:10px;
      padding:10px 10px 8px;
      border-radius:12px;
      border:1px solid rgba(255,200,135,0.88);
      background:linear-gradient(135deg,rgba(10,14,32,0.96),rgba(4,6,20,0.98));
      box-shadow:0 0 14px rgba(255,200,135,0.6);
      font-size:12px;
    }
    .cmc-title{
      font-size:11px;
      letter-spacing:1px;
      opacity:.82;
      margin-bottom:4px;
      color:#ffe9b0;
    }
    .cmc-line{
      display:flex;
      justify-content:space-between;
      gap:6px;
      margin:1px 0;
    }
    .cmc-label{opacity:.75;}
    .cmc-value{text-align:right;font-weight:500;}

  </style>
</head>
<body>
  <div class="stars"></div>
  <div class="tribal"></div>

  <div class="page">
    <div class="card">
      <div class="left">
        <div class="badge">LEVEL 23 Â· CHARACTER CREATION</div>
        <h1>è§’è‰²å‰µå»ºå„€å¼</h1>
        <div class="subtitle">
          ä½ å·²é€šéç™»å…¥é–€æª»ï¼Œç¾åœ¨è«‹æ›¿è‡ªå·±å®Œæˆä¸€å¼µ <strong>Level 23 è§’è‰²å¡</strong>ã€‚<br>
          é€™äº›è³‡è¨Šä¹‹å¾Œå¯ä»¥ç”¨åœ¨åç‰Œã€åˆ†çµ„ï¼Œæˆ–æ´»å‹•çµæŸå¾Œçš„è§’è‰²åœ–é‘‘ã€‚
        </div>
        <div class="player-meta">
          <div><span class="label">ç™»å…¥ç©å®¶ï¼š</span><span id="metaName">Player</span></div>
          <div><span class="label">è¯çµ¡é›»è©±ï¼š</span><span id="metaPhone">-</span></div>
        </div>
        <div class="preview-card">
          <div class="preview-line">
            <span class="preview-label">è§’è‰²åç¨±ï¼š</span>
            <span class="preview-value" id="pvCharName">å°šæœªè¼¸å…¥</span>
          </div>
          <div class="preview-line">
            <span class="preview-label">è·æ¥­ / èº«åˆ†ï¼š</span>
            <span class="preview-value" id="pvRole">å°šæœªé¸æ“‡</span>
          </div>
          <div class="preview-line">
            <span class="preview-label">å…ƒç´ å±¬æ€§ï¼š</span>
            <span class="preview-value" id="pvElement">å°šæœªé¸æ“‡</span>
          </div>
          <div class="preview-line">
            <span class="preview-label">ä¾†è‡ªéƒ¨è½ / åœ°é»ï¼š</span>
            <span class="preview-value" id="pvTribe">å°šæœªè¨­å®š</span>
          </div>
        </div>
      </div>
      <div class="right">
        <form id="characterForm">
          <div class="field">
            <label for="charName">è§’è‰²åç¨±</label>
            <input id="charName" type="text" placeholder="ä¾‹ï¼šKutra é‡€é…’å¸«ã€å°ç±³å®ˆè­·è€…â€¦" />
          </div>
          <div class="field">
            <label for="tribe">éƒ¨è½ / ä¾†è‡ªå“ªè£¡</label>
            <input id="tribe" type="text" placeholder="ä¾‹ï¼šå‘å—æ—ãƒ»åˆé¹¿éƒ¨è½ / ä¸­åŸå¤§å­¸â€¦" />
          </div>
          <div class="field">
            <label for="role">è·æ¥­ / èº«åˆ†</label>
            <select id="role">
              <option value="">è«‹é¸æ“‡</option>
              <option value="é‡€é…’å¸« Brewer" style="color:#ffc857;">é‡€é…’å¸« Brewer</option>
              <option value="èˆè€… Dancer" style="color:#ff80c8;">èˆè€… Dancer</option>
              <option value="å®ˆè­·è€… Guardian" style="color:#5be4ff;">å®ˆè­·è€… Guardian</option>
              <option value="çµäºº Hunter" style="color:#78e38f;">çµäºº Hunter</option>
              <option value="æ²»ç™‚è€… Healer" style="color:#b6ffce;">æ²»ç™‚è€… Healer</option>
              <option value="ç­–å£« Strategist" style="color:#c9a4ff;">ç­–å£« Strategist</option>
              <option value="æ—…äºº Traveler" style="color:#ffb480;">æ—…äºº Traveler</option>
              <option value="è‡ªç”±å®¢ Free Spirit" style="color:#7af2ff;">è‡ªç”±å®¢ Free Spirit</option>
              <option value="å…¶ä»– Custom" style="color:#d0d5e5;">å…¶ä»– Custom</option>
            </select>
          </div>
          <div class="field">
            <label for="element">å…ƒç´ å±¬æ€§</label>
            <select id="element">
              <option value="">è«‹é¸æ“‡</option>
              <option value="åœŸãƒ»åœŸåœ° Earth" style="color:#c8a15b;">åœŸãƒ»åœŸåœ° Earth</option>
              <option value="ç«ãƒ»é‡€é…’ Fire" style="color:#ff6b6b;">ç«ãƒ»é‡€é…’ Fire</option>
              <option value="é¢¨ãƒ»èˆè¹ˆ Wind" style="color:#7fd5ff;">é¢¨ãƒ»èˆè¹ˆ Wind</option>
              <option value="æ°´ãƒ»æƒ…æ„Ÿ Water" style="color:#4aaeff;">æ°´ãƒ»æƒ…æ„Ÿ Water</option>
              <option value="æ˜Ÿãƒ»å¤¢æƒ³ Star" style="color:#ffe27a;">æ˜Ÿãƒ»å¤¢æƒ³ Star</option>
              <option value="å½±ãƒ»æ²‰æ€ Shadow" style="color:#a18bff;">å½±ãƒ»æ²‰æ€ Shadow</option>
            </select>
          </div>
          <div class="field-title">èƒ½åŠ›å€¼åˆ†é…ï¼ˆ0â€“10ï¼Œè‡ªç”±åŠ é»ï¼‰</div>
          <div class="stats-row">
            <div class="stat-box">
              <span>åŠ›é‡ STR</span>
              <input id="str" type="number" min="0" max="10" value="3" />
            </div>
            <div class="stat-box">
              <span>æ™ºæ…§ INT</span>
              <input id="int" type="number" min="0" max="10" value="3" />
            </div>
            <div class="stat-box">
              <span>é­…åŠ› CHA</span>
              <input id="cha" type="number" min="0" max="10" value="3" />
            </div>
            <div class="stat-box">
              <span>å¹¸é‹ LUCK</span>
              <input id="luck" type="number" min="0" max="10" value="3" />
            </div>
          </div>
          <div class="field-title">æƒ³èªªçš„è©±ï¼ˆçµ¦å£½æ˜Ÿ / éƒ¨è½ / é€™æ¬¡ Level 23 å„€å¼ï¼‰</div>
          <div class="field" style="grid-column:1/-1;">
            <textarea id="message" placeholder="å¯«ä¸€æ®µè©±ï¼Œå¯ä»¥æ˜¯ç¥ç¦ã€å›æ†¶ã€æˆ–æ˜¯å°é€™æ¬¡èšæœƒçš„æ„Ÿæƒ³â€¦"></textarea>
          </div>
          <div class="actions">
            <button type="button" class="btn btn-ghost" onclick="goBack()">â† å›åˆ°ç™»å…¥é </button>
            <button type="submit" class="btn btn-primary">å„²å­˜è§’è‰²è³‡è¨Š âœ”</button>
          </div>
          <div class="hint">è³‡æ–™æœƒæš«å­˜åœ¨ä½ çš„ç€è¦½å™¨ï¼ˆlocalStorageï¼‰ï¼Œä¸¦é€åˆ° Google è¡¨å–®ä¾›ä½ æ•´ç†ã€‚</div>
        </form>
      </div>
    </div>
  </div>
  <div id="toast" class="toast">è§’è‰²è³‡è¨Šå·²å„²å­˜ âœ”</div>

  <script>
    const playerName=sessionStorage.getItem("playerName")||"Player";
    const playerPhone=sessionStorage.getItem("playerPhone")||"";
    document.getElementById("metaName").textContent=playerName;
    document.getElementById("metaPhone").textContent=playerPhone||"-";
    document.getElementById("charName").value=playerName;

    const charNameInput=document.getElementById("charName");
    const tribeInput=document.getElementById("tribe");
    const roleSelect=document.getElementById("role");
    const elementSelect=document.getElementById("element");
    const pvCharName=document.getElementById("pvCharName");
    const pvRole=document.getElementById("pvRole");
    const pvElement=document.getElementById("pvElement");
    const pvTribe=document.getElementById("pvTribe");

    function updatePreview(){
      pvCharName.textContent=charNameInput.value||"å°šæœªè¼¸å…¥";
      pvRole.textContent=roleSelect.value||"å°šæœªé¸æ“‡";
      pvElement.textContent=elementSelect.value||"å°šæœªé¸æ“‡";
      pvTribe.textContent=tribeInput.value||"å°šæœªè¨­å®š";

      const card=document.querySelector(".preview-card");
      if(card){
        const role=roleSelect.value||"";
        const element=elementSelect.value||"";
        let border="#ffc857";
        let glow="rgba(255,200,135,.7)";

        if(element.includes("ç«")){border="#ff6b6b";glow="rgba(255,107,107,.75)";}
        else if(element.includes("æ°´")){border="#4aaeff";glow="rgba(74,174,255,.75)";}
        else if(element.includes("é¢¨")){border="#7fd5ff";glow="rgba(127,213,255,.75)";}
        else if(element.includes("åœŸ")){border="#c8a15b";glow="rgba(200,161,91,.75)";}
        else if(element.includes("æ˜Ÿ")){border="#ffe27a";glow="rgba(255,226,122,.8)";}
        else if(element.includes("å½±")){border="#a18bff";glow="rgba(161,139,255,.75)";}

        if(role.includes("é‡€é…’å¸«")) border="#ffc857";
        else if(role.includes("èˆè€…")) border="#ff80c8";
        else if(role.includes("å®ˆè­·è€…")) border="#5be4ff";
        else if(role.includes("çµäºº")) border="#78e38f";
        else if(role.includes("æ²»ç™‚è€…")) border="#b6ffce";
        else if(role.includes("ç­–å£«")) border="#c9a4ff";
        else if(role.includes("æ—…äºº")) border="#ffb480";
        else if(role.includes("è‡ªç”±å®¢")) border="#7af2ff";

        card.style.borderColor=border;
        card.style.boxShadow=`0 0 18px ${glow}`;
      }
    }
    [charNameInput,tribeInput,roleSelect,elementSelect].forEach(el=>{
      el.addEventListener("input",updatePreview);
      el.addEventListener("change",updatePreview);
    });
    updatePreview();

    const GOOGLE_FORM_URL="https://docs.google.com/forms/u/0/d/e/1FAIpQLSfV50KRQIQW5MzlvodEHaNSRWxAbr9UNhioqpqRuA9ZftYbCg/formResponse";
    const GOOGLE_FIELDS={
      playerName:"entry.1692967079",
      playerPhone:"entry.1724405603",
      charName:"entry.1815456712",
      tribe:"entry.70379778",
      role:"entry.71969897",
      element:"entry.227903663",
      str:"entry.1290922171",
      int:"entry.557939827",
      cha:"entry.1703247253",
      luck:"entry.1483548557",
      message:"entry.232807868"
    };

    function showToast(msg){
      const t=document.getElementById("toast");
      t.textContent=msg;
      t.classList.add("show");
      setTimeout(()=>t.classList.remove("show"),2000);
    }
    function goBack(){window.location.href="index.html";}

    async function submitToGoogle(data){
      const fd=new FormData();
      fd.append(GOOGLE_FIELDS.playerName,data.playerName);
      fd.append(GOOGLE_FIELDS.playerPhone,data.playerPhone);
      fd.append(GOOGLE_FIELDS.charName,data.charName);
      fd.append(GOOGLE_FIELDS.tribe,data.tribe);
      fd.append(GOOGLE_FIELDS.role,data.role);
      fd.append(GOOGLE_FIELDS.element,data.element);
      fd.append(GOOGLE_FIELDS.str,data.stats.str);
      fd.append(GOOGLE_FIELDS.int,data.stats.int);
      fd.append(GOOGLE_FIELDS.cha,data.stats.cha);
      fd.append(GOOGLE_FIELDS.luck,data.stats.luck);
      fd.append(GOOGLE_FIELDS.message,data.message);
      try{
        await fetch(GOOGLE_FORM_URL,{method:"POST",mode:"no-cors",body:fd});
      }catch(e){console.warn("Google è¡¨å–®é€å‡ºéŒ¯èª¤",e);}
    }

    const form=document.getElementById("characterForm");
    form.addEventListener("submit",async e=>{
      e.preventDefault();
      const data={
        playerName,playerPhone,
        charName:charNameInput.value,
        tribe:tribeInput.value,
        role:roleSelect.value,
        element:elementSelect.value,
        stats:{
          str:document.getElementById("str").value,
          int:document.getElementById("int").value,
          cha:document.getElementById("cha").value,
          luck:document.getElementById("luck").value
        },
        message:document.getElementById("message").value,
        savedAt:new Date().toISOString()
      };
      const list=JSON.parse(localStorage.getItem("level23Characters")||"[]");
      list.push(data);
      localStorage.setItem("level23Characters",JSON.stringify(list));
      localStorage.setItem("level23LastCharacter",JSON.stringify(data));
      await submitToGoogle(data);
      showToast("è§’è‰²è³‡è¨Šå·²å„²å­˜ âœ”");
      showCompletion(data);
      // è‹¥è¦ç›´æ¥è·³åœ–é‘‘å¯æ”¹æˆï¼šwindow.location.href="entry-card.html";
    });
  
    function showCompletion(data){
      const overlay=document.getElementById("completionOverlay");
      if(!overlay) return;
      document.getElementById("cCharName").textContent=data.charName||"æœªå‘½åè§’è‰²";
      document.getElementById("cRole").textContent=data.role||"æœªè¨­å®šè·æ¥­";
      document.getElementById("cElement").textContent=data.element||"â”€";
      document.getElementById("cTribe").textContent=data.tribe||"â”€";
      document.getElementById("cStr").textContent=data.stats?.str||"-";
      document.getElementById("cInt").textContent=data.stats?.int||"-";
      document.getElementById("cCha").textContent=data.stats?.cha||"-";
      document.getElementById("cLuck").textContent=data.stats?.luck||"-";

      const miniName=document.getElementById("cmcCharName");
      const miniRole=document.getElementById("cmcRole");
      const miniElement=document.getElementById("cmcElement");
      const miniTribe=document.getElementById("cmcTribe");
      if(miniName) miniName.textContent=data.charName||"æœªå‘½åè§’è‰²";
      if(miniRole) miniRole.textContent=data.role||"æœªè¨­å®šè·æ¥­";
      if(miniElement) miniElement.textContent=data.element||"â”€";
      if(miniTribe) miniTribe.textContent=data.tribe||"â”€";

      const avatarImg=document.getElementById("completionAvatar");
      if(avatarImg){
        const storedAvatar=sessionStorage.getItem("playerAvatar");
        if(storedAvatar) avatarImg.src=storedAvatar;
      }

      const role=data.role||"";
      const element=data.element||"";
      let border="#ffc857";
      let glow="rgba(255,200,135,.7)";

      if(element.includes("ç«")){border="#ff6b6b";glow="rgba(255,107,107,.75)";}
      else if(element.includes("æ°´")){border="#4aaeff";glow="rgba(74,174,255,.75)";}
      else if(element.includes("é¢¨")){border="#7fd5ff";glow="rgba(127,213,255,.75)";}
      else if(element.includes("åœŸ")){border="#c8a15b";glow="rgba(200,161,91,.75)";}
      else if(element.includes("æ˜Ÿ")){border="#ffe27a";glow="rgba(255,226,122,.8)";}
      else if(element.includes("å½±")){border="#a18bff";glow="rgba(161,139,255,.75)";}

      if(role.includes("é‡€é…’å¸«")) border="#ffc857";
      else if(role.includes("èˆè€…")) border="#ff80c8";
      else if(role.includes("å®ˆè­·è€…")) border="#5be4ff";
      else if(role.includes("çµäºº")) border="#78e38f";
      else if(role.includes("æ²»ç™‚è€…")) border="#b6ffce";
      else if(role.includes("ç­–å£«")) border="#c9a4ff";
      else if(role.includes("æ—…äºº")) border="#ffb480";
      else if(role.includes("è‡ªç”±å®¢")) border="#7af2ff";

      const panel=document.querySelector(".completion-panel");
      const miniCard=document.getElementById("completionMiniCard");
      if(panel){
        panel.style.borderColor=border;
        panel.style.boxShadow=`0 0 26px ${glow},0 0 34px ${glow}`;
      }
      if(miniCard){
        miniCard.style.borderColor=border;
        miniCard.style.boxShadow=`0 0 18px ${glow}`;
      }

      overlay.style.display="flex";
    }
    document.addEventListener("DOMContentLoaded",()=>{
      const galleryBtn=document.getElementById("goGalleryBtn");
      if(galleryBtn){
        galleryBtn.addEventListener("click",()=>{
          window.location.href="entry-card.html";
        });
      }
    });

  </script>

  <div class="completion-overlay" id="completionOverlay">
    <div class="completion-panel">
      <div class="completion-avatar-wrap">
        <div class="completion-avatar-glow"></div>
        <img id="completionAvatar" src="assets/characters/default.png" alt="avatar" />
      </div>

      <div class="completion-title">å‰µè§’å®Œæˆ</div>
      <div class="completion-sub">ä½ çš„è§’è‰²å·²æˆåŠŸç™»å…¥ Level 23 å„€å¼ã€‚</div>

      <div class="completion-mini-card" id="completionMiniCard">
        <div class="cmc-title">å…¥å ´è§’è‰²å¡é è¦½</div>
        <div class="cmc-line">
          <span class="cmc-label">è§’è‰²ï¼š</span><span class="cmc-value" id="cmcCharName">â”€</span>
        </div>
        <div class="cmc-line">
          <span class="cmc-label">è·æ¥­ï¼š</span><span class="cmc-value" id="cmcRole">â”€</span>
        </div>
        <div class="cmc-line">
          <span class="cmc-label">å…ƒç´ ï¼š</span><span class="cmc-value" id="cmcElement">â”€</span>
        </div>
        <div class="cmc-line">
          <span class="cmc-label">ä¾†è‡ªï¼š</span><span class="cmc-value" id="cmcTribe">â”€</span>
        </div>
      </div>

      <div class="completion-line">
        <span class="label">è§’è‰²åç¨±ï¼š</span><span id="cCharName">â”€</span>
      </div>
      <div class="completion-line">
        <span class="label">è·æ¥­ / èº«åˆ†ï¼š</span><span id="cRole">â”€</span>
      </div>
      <div class="completion-line">
        <span class="label">å…ƒç´ å±¬æ€§ï¼š</span><span id="cElement">â”€</span>
      </div>
      <div class="completion-line">
        <span class="label">ä¾†è‡ªï¼š</span><span id="cTribe">â”€</span>
      </div>

      <div class="completion-line" style="margin-top:8px;">
        <span class="label">èƒ½åŠ›å€¼ï¼š</span>
        STR <span id="cStr">-</span> ï¼
        INT <span id="cInt">-</span> ï¼
        CHA <span id="cCha">-</span> ï¼
        LUCK <span id="cLuck">-</span>
      </div>

      <div class="completion-line" style="margin-top:10px;">
        <span class="label">é›†åˆæ™‚é–“åœ°é»ï¼š</span><br>
        12/20 æ™šä¸Š 10ï¼š30ã€€ä¸­å£¢å¥½æ¨‚è¿ª KTV
      </div>

      <div class="completion-actions">
        <button class="completion-btn completion-btn-primary" id="goGalleryBtn">
          æŸ¥çœ‹è§’è‰²å¡
        </button>
      </div>
    </div>
  </div>


  <!-- ğŸ”Š èƒŒæ™¯éŸ³æ¨‚ï¼šéŸ³é‡è¼ƒå°ï¼Œå¾ªç’°æ’­æ”¾ -->
  <audio id="bgm" src="assets/music/bg.mp3" autoplay loop></audio>
  <script>
    (function(){
      const bgm = document.getElementById("bgm");
      if (!bgm) return;
      bgm.volume = 0.15; // ä¸è¦å¤ªå¤§è²

      // æ‰‹æ©Ÿèˆ‡ç€è¦½å™¨ç‚ºäº†è‡ªå‹•æ’­æ”¾æ”¿ç­–ï¼Œç¬¬ä¸€æ¬¡äº’å‹•å¾Œå†ç¢ºä¿æ’­æ”¾
      function resumeBgm(){
        if (bgm.paused) {
          bgm.play().catch(()=>{});
        }
        document.removeEventListener("click", resumeBgm);
        document.removeEventListener("touchstart", resumeBgm);
      }
      document.addEventListener("click", resumeBgm);
      document.addEventListener("touchstart", resumeBgm);
    })();
  </script>

</body>
</html>
